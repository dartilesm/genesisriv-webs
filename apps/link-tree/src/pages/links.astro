---
import LinksContainer from "@/components/links-container.astro";
import RootLayout from "@/layouts/root-layout.astro";
import { loadQuery } from "@/utils/sanity-load-query";
import type { LinkTree, Metadata } from "@sanity-app/sanity.types";
const {
  data: [siteData],
} = await loadQuery<LinkTree[]>({
  query: `*[_type == "linkTree"]`,
});

const {
  data: [linkTreeMetadata],
} = await loadQuery<Metadata[]>({
  query: `*[_type == "metadata"]`,
});
---

<RootLayout className='space-y-0 py-0' bodyClassName='items-start' metadata={linkTreeMetadata}>
  <div class='w-full max-w-xl mx-auto flex flex-col gap-4 min-h-[calc(100vh-2rem)]'>
    {/* Header with back button */}
    <div class='flex items-center py-2 sticky top-0 bg-white/90 z-10'>
      <a
        href='/'
        class='inline-flex items-center justify-center w-8 h-8 mr-4 text-gray-600 hover:text-purple-600 hover:bg-purple-50 rounded-full transition-all'
      >
        <title>Back button</title>
        <svg
          xmlns='http://www.w3.org/2000/svg'
          class='h-5 w-5'
          viewBox='0 0 24 24'
          fill='none'
          stroke='currentColor'
          stroke-width='2'
        >
          <path d='M15 19l-7-7 7-7'></path>
        </svg>
      </a>
    </div>

    <LinksContainer data={siteData?.additionalLinks?.links?.[0]} />
  </div>
</RootLayout>

<script define:vars={{ siteData }}>
  document.addEventListener("astro:page-load", () => {
    console.log(siteData);
  });
</script>
